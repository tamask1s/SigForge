FileOpen(Recording_01.bdf, ekgsignaldata);
DataIn(ekgsignaldata, ekgsignal); 
CreateFilter(bandpass_filter, butterworth bp, 2 2000, 5 20);
Filter(ekgsignal, bandpass_filter);
FilterReverse(ekgsignal, bandpass_filter);

CreateFilter(derivative_filter, butterworth hp, 2 2000, 10);
Filter(ekgsignal, derivative_filter);
FilterReverse(ekgsignal, derivative_filter);

SQR_Inplace(ekgsignal);

CreateFilter(integrative_filter, butterworth lp, 2 2000, 8);
Filter(ekgsignal, integrative_filter);
FilterReverse(ekgsignal, integrative_filter);

Copy(ekgsignal_threshold, ekgsignal);

CreateFilter(threshold_filter, butterworth lp, 2 2000, 1.5);
Filter(ekgsignal_threshold, threshold_filter);
FilterReverse(ekgsignal_threshold, threshold_filter);

DetectSpikes(spike_signal, ekgsignal, ekgsignal_threshold);

Cat(ekgsignal, ekgsignal_threshold);
Cat(ekgsignal, spike_signal);

DisplayData(ekgsignal);
